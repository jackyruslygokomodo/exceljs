{"version":3,"file":"auto-filter-xform.js","names":["BaseXform","require","FilterColumnXform","AutoFilterXform","map","filterColumn","model","columns","forEach","column","index","prepare","xmlStream","openNode","tag","ref","autoFilterRef","render","closeNode","node","parser","parseOpen","name","attributes","Error","JSON","stringify","text","parseText","parseClose","push","undefined","module","exports"],"sources":["../../../../../lib/xlsx/xform/table/auto-filter-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\n\nconst FilterColumnXform = require('./filter-column-xform');\n\nclass AutoFilterXform extends BaseXform {\n  constructor() {\n    super();\n\n    this.map = {\n      filterColumn: new FilterColumnXform(),\n    };\n  }\n\n  get tag() {\n    return 'autoFilter';\n  }\n\n  prepare(model) {\n    model.columns.forEach((column, index) => {\n      this.map.filterColumn.prepare(column, {index});\n    });\n  }\n\n  render(xmlStream, model) {\n    xmlStream.openNode(this.tag, {ref: model.autoFilterRef});\n\n    model.columns.forEach(column => {\n      this.map.filterColumn.render(xmlStream, column);\n    });\n\n    xmlStream.closeNode();\n    return true;\n  }\n\n  parseOpen(node) {\n    if (this.parser) {\n      this.parser.parseOpen(node);\n      return true;\n    }\n    switch (node.name) {\n      case this.tag:\n        this.model = {\n          autoFilterRef: node.attributes.ref,\n          columns: [],\n        };\n        return true;\n\n      default:\n        this.parser = this.map[node.name];\n        if (this.parser) {\n          this.parseOpen(node);\n          return true;\n        }\n        throw new Error(`Unexpected xml node in parseOpen: ${JSON.stringify(node)}`);\n    }\n  }\n\n  parseText(text) {\n    if (this.parser) {\n      this.parser.parseText(text);\n    }\n  }\n\n  parseClose(name) {\n    if (this.parser) {\n      if (!this.parser.parseClose(name)) {\n        this.model.columns.push(this.parser.model);\n        this.parser = undefined;\n      }\n      return true;\n    }\n    switch (name) {\n      case this.tag:\n        return false;\n      default:\n        throw new Error(`Unexpected xml node in parseClose: ${name}`);\n    }\n  }\n}\n\nmodule.exports = AutoFilterXform;\n"],"mappings":";;;;;;;;;;;;;;;AAAA,IAAMA,SAAS,GAAGC,OAAO,CAAC,eAAe,CAAC;AAE1C,IAAMC,iBAAiB,GAAGD,OAAO,CAAC,uBAAuB,CAAC;AAAC,IAErDE,eAAe;EAAA;EAAA;EACnB,2BAAc;IAAA;IAAA;IACZ;IAEA,MAAKC,GAAG,GAAG;MACTC,YAAY,EAAE,IAAIH,iBAAiB;IACrC,CAAC;IAAC;EACJ;EAAC;IAAA;IAAA,KAED,eAAU;MACR,OAAO,YAAY;IACrB;EAAC;IAAA;IAAA,OAED,iBAAQI,KAAK,EAAE;MAAA;MACbA,KAAK,CAACC,OAAO,CAACC,OAAO,CAAC,UAACC,MAAM,EAAEC,KAAK,EAAK;QACvC,MAAI,CAACN,GAAG,CAACC,YAAY,CAACM,OAAO,CAACF,MAAM,EAAE;UAACC,KAAK,EAALA;QAAK,CAAC,CAAC;MAChD,CAAC,CAAC;IACJ;EAAC;IAAA;IAAA,OAED,gBAAOE,SAAS,EAAEN,KAAK,EAAE;MAAA;MACvBM,SAAS,CAACC,QAAQ,CAAC,IAAI,CAACC,GAAG,EAAE;QAACC,GAAG,EAAET,KAAK,CAACU;MAAa,CAAC,CAAC;MAExDV,KAAK,CAACC,OAAO,CAACC,OAAO,CAAC,UAAAC,MAAM,EAAI;QAC9B,MAAI,CAACL,GAAG,CAACC,YAAY,CAACY,MAAM,CAACL,SAAS,EAAEH,MAAM,CAAC;MACjD,CAAC,CAAC;MAEFG,SAAS,CAACM,SAAS,EAAE;MACrB,OAAO,IAAI;IACb;EAAC;IAAA;IAAA,OAED,mBAAUC,IAAI,EAAE;MACd,IAAI,IAAI,CAACC,MAAM,EAAE;QACf,IAAI,CAACA,MAAM,CAACC,SAAS,CAACF,IAAI,CAAC;QAC3B,OAAO,IAAI;MACb;MACA,QAAQA,IAAI,CAACG,IAAI;QACf,KAAK,IAAI,CAACR,GAAG;UACX,IAAI,CAACR,KAAK,GAAG;YACXU,aAAa,EAAEG,IAAI,CAACI,UAAU,CAACR,GAAG;YAClCR,OAAO,EAAE;UACX,CAAC;UACD,OAAO,IAAI;QAEb;UACE,IAAI,CAACa,MAAM,GAAG,IAAI,CAAChB,GAAG,CAACe,IAAI,CAACG,IAAI,CAAC;UACjC,IAAI,IAAI,CAACF,MAAM,EAAE;YACf,IAAI,CAACC,SAAS,CAACF,IAAI,CAAC;YACpB,OAAO,IAAI;UACb;UACA,MAAM,IAAIK,KAAK,6CAAsCC,IAAI,CAACC,SAAS,CAACP,IAAI,CAAC,EAAG;MAAC;IAEnF;EAAC;IAAA;IAAA,OAED,mBAAUQ,IAAI,EAAE;MACd,IAAI,IAAI,CAACP,MAAM,EAAE;QACf,IAAI,CAACA,MAAM,CAACQ,SAAS,CAACD,IAAI,CAAC;MAC7B;IACF;EAAC;IAAA;IAAA,OAED,oBAAWL,IAAI,EAAE;MACf,IAAI,IAAI,CAACF,MAAM,EAAE;QACf,IAAI,CAAC,IAAI,CAACA,MAAM,CAACS,UAAU,CAACP,IAAI,CAAC,EAAE;UACjC,IAAI,CAAChB,KAAK,CAACC,OAAO,CAACuB,IAAI,CAAC,IAAI,CAACV,MAAM,CAACd,KAAK,CAAC;UAC1C,IAAI,CAACc,MAAM,GAAGW,SAAS;QACzB;QACA,OAAO,IAAI;MACb;MACA,QAAQT,IAAI;QACV,KAAK,IAAI,CAACR,GAAG;UACX,OAAO,KAAK;QACd;UACE,MAAM,IAAIU,KAAK,8CAAuCF,IAAI,EAAG;MAAC;IAEpE;EAAC;EAAA;AAAA,EAzE2BtB,SAAS;AA4EvCgC,MAAM,CAACC,OAAO,GAAG9B,eAAe"}