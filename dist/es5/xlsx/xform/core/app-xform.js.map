{"version":3,"file":"app-xform.js","names":["XmlStream","require","BaseXform","StringXform","AppHeadingPairsXform","AppTitleOfPartsXform","AppXform","map","Company","tag","Manager","HeadingPairs","TitleOfParts","xmlStream","model","openXml","StdDocAttributes","openNode","PROPERTY_ATTRIBUTES","leafNode","undefined","render","worksheets","company","manager","closeNode","node","parser","parseOpen","name","text","parseText","parseClose","DateFormat","dt","toISOString","replace","DateAttrs","xmlns","module","exports"],"sources":["../../../../../lib/xlsx/xform/core/app-xform.js"],"sourcesContent":["const XmlStream = require('../../../utils/xml-stream');\nconst BaseXform = require('../base-xform');\nconst StringXform = require('../simple/string-xform');\n\nconst AppHeadingPairsXform = require('./app-heading-pairs-xform');\nconst AppTitleOfPartsXform = require('./app-titles-of-parts-xform');\n\nclass AppXform extends BaseXform {\n  constructor() {\n    super();\n\n    this.map = {\n      Company: new StringXform({tag: 'Company'}),\n      Manager: new StringXform({tag: 'Manager'}),\n      HeadingPairs: new AppHeadingPairsXform(),\n      TitleOfParts: new AppTitleOfPartsXform(),\n    };\n  }\n\n  render(xmlStream, model) {\n    xmlStream.openXml(XmlStream.StdDocAttributes);\n\n    xmlStream.openNode('Properties', AppXform.PROPERTY_ATTRIBUTES);\n\n    xmlStream.leafNode('Application', undefined, 'Microsoft Excel');\n    xmlStream.leafNode('DocSecurity', undefined, '0');\n    xmlStream.leafNode('ScaleCrop', undefined, 'false');\n\n    this.map.HeadingPairs.render(xmlStream, model.worksheets);\n    this.map.TitleOfParts.render(xmlStream, model.worksheets);\n    this.map.Company.render(xmlStream, model.company || '');\n    this.map.Manager.render(xmlStream, model.manager);\n\n    xmlStream.leafNode('LinksUpToDate', undefined, 'false');\n    xmlStream.leafNode('SharedDoc', undefined, 'false');\n    xmlStream.leafNode('HyperlinksChanged', undefined, 'false');\n    xmlStream.leafNode('AppVersion', undefined, '16.0300');\n\n    xmlStream.closeNode();\n  }\n\n  parseOpen(node) {\n    if (this.parser) {\n      this.parser.parseOpen(node);\n      return true;\n    }\n    switch (node.name) {\n      case 'Properties':\n        return true;\n      default:\n        this.parser = this.map[node.name];\n        if (this.parser) {\n          this.parser.parseOpen(node);\n          return true;\n        }\n\n        // there's a lot we don't bother to parse\n        return false;\n    }\n  }\n\n  parseText(text) {\n    if (this.parser) {\n      this.parser.parseText(text);\n    }\n  }\n\n  parseClose(name) {\n    if (this.parser) {\n      if (!this.parser.parseClose(name)) {\n        this.parser = undefined;\n      }\n      return true;\n    }\n    switch (name) {\n      case 'Properties':\n        this.model = {\n          worksheets: this.map.TitleOfParts.model,\n          company: this.map.Company.model,\n          manager: this.map.Manager.model,\n        };\n        return false;\n      default:\n        return true;\n    }\n  }\n}\n\nAppXform.DateFormat = function(dt) {\n  return dt.toISOString().replace(/[.]\\d{3,6}/, '');\n};\n\nAppXform.DateAttrs = {'xsi:type': 'dcterms:W3CDTF'};\n\nAppXform.PROPERTY_ATTRIBUTES = {\n  xmlns: 'http://schemas.openxmlformats.org/officeDocument/2006/extended-properties',\n  'xmlns:vt': 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes',\n};\n\nmodule.exports = AppXform;\n"],"mappings":"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"}