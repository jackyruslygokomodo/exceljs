{"version":3,"file":"conditional-formatting-ext-xform.js","names":["CompositeXform","require","SqRefExtXform","CfRuleExtXform","ConditionalFormattingExtXform","map","sqRef","cfRule","model","options","rules","forEach","rule","prepare","xmlStream","some","isExt","openNode","tag","filter","render","ref","closeNode","name","parser","push","module","exports"],"sources":["../../../../../../lib/xlsx/xform/sheet/cf-ext/conditional-formatting-ext-xform.js"],"sourcesContent":["const CompositeXform = require('../../composite-xform');\n\nconst SqRefExtXform = require('./sqref-ext-xform');\nconst CfRuleExtXform = require('./cf-rule-ext-xform');\n\nclass ConditionalFormattingExtXform extends CompositeXform {\n  constructor() {\n    super();\n\n    this.map = {\n      'xm:sqref': (this.sqRef = new SqRefExtXform()),\n      'x14:cfRule': (this.cfRule = new CfRuleExtXform()),\n    };\n  }\n\n  get tag() {\n    return 'x14:conditionalFormatting';\n  }\n\n  prepare(model, options) {\n    model.rules.forEach(rule => {\n      this.cfRule.prepare(rule, options);\n    });\n  }\n\n  render(xmlStream, model) {\n    if (!model.rules.some(CfRuleExtXform.isExt)) {\n      return;\n    }\n\n    xmlStream.openNode(this.tag, {\n      'xmlns:xm': 'http://schemas.microsoft.com/office/excel/2006/main',\n    });\n\n    model.rules.filter(CfRuleExtXform.isExt).forEach(rule => this.cfRule.render(xmlStream, rule));\n\n    // for some odd reason, Excel needs the <xm:sqref> node to be after the rules\n    this.sqRef.render(xmlStream, model.ref);\n\n    xmlStream.closeNode();\n  }\n\n  createNewModel() {\n    return {\n      rules: [],\n    };\n  }\n\n  onParserClose(name, parser) {\n    switch (name) {\n      case 'xm:sqref':\n        this.model.ref = parser.model;\n        break;\n\n      case 'x14:cfRule':\n        this.model.rules.push(parser.model);\n        break;\n    }\n  }\n}\n\nmodule.exports = ConditionalFormattingExtXform;\n"],"mappings":";;;;;;;;;;;;;;;AAAA,IAAMA,cAAc,GAAGC,OAAO,CAAC,uBAAuB,CAAC;AAEvD,IAAMC,aAAa,GAAGD,OAAO,CAAC,mBAAmB,CAAC;AAClD,IAAME,cAAc,GAAGF,OAAO,CAAC,qBAAqB,CAAC;AAAC,IAEhDG,6BAA6B;EAAA;EAAA;EACjC,yCAAc;IAAA;IAAA;IACZ;IAEA,MAAKC,GAAG,GAAG;MACT,UAAU,EAAG,MAAKC,KAAK,GAAG,IAAIJ,aAAa,EAAG;MAC9C,YAAY,EAAG,MAAKK,MAAM,GAAG,IAAIJ,cAAc;IACjD,CAAC;IAAC;EACJ;EAAC;IAAA;IAAA,KAED,eAAU;MACR,OAAO,2BAA2B;IACpC;EAAC;IAAA;IAAA,OAED,iBAAQK,KAAK,EAAEC,OAAO,EAAE;MAAA;MACtBD,KAAK,CAACE,KAAK,CAACC,OAAO,CAAC,UAAAC,IAAI,EAAI;QAC1B,MAAI,CAACL,MAAM,CAACM,OAAO,CAACD,IAAI,EAAEH,OAAO,CAAC;MACpC,CAAC,CAAC;IACJ;EAAC;IAAA;IAAA,OAED,gBAAOK,SAAS,EAAEN,KAAK,EAAE;MAAA;MACvB,IAAI,CAACA,KAAK,CAACE,KAAK,CAACK,IAAI,CAACZ,cAAc,CAACa,KAAK,CAAC,EAAE;QAC3C;MACF;MAEAF,SAAS,CAACG,QAAQ,CAAC,IAAI,CAACC,GAAG,EAAE;QAC3B,UAAU,EAAE;MACd,CAAC,CAAC;MAEFV,KAAK,CAACE,KAAK,CAACS,MAAM,CAAChB,cAAc,CAACa,KAAK,CAAC,CAACL,OAAO,CAAC,UAAAC,IAAI;QAAA,OAAI,MAAI,CAACL,MAAM,CAACa,MAAM,CAACN,SAAS,EAAEF,IAAI,CAAC;MAAA,EAAC;;MAE7F;MACA,IAAI,CAACN,KAAK,CAACc,MAAM,CAACN,SAAS,EAAEN,KAAK,CAACa,GAAG,CAAC;MAEvCP,SAAS,CAACQ,SAAS,EAAE;IACvB;EAAC;IAAA;IAAA,OAED,0BAAiB;MACf,OAAO;QACLZ,KAAK,EAAE;MACT,CAAC;IACH;EAAC;IAAA;IAAA,OAED,uBAAca,IAAI,EAAEC,MAAM,EAAE;MAC1B,QAAQD,IAAI;QACV,KAAK,UAAU;UACb,IAAI,CAACf,KAAK,CAACa,GAAG,GAAGG,MAAM,CAAChB,KAAK;UAC7B;QAEF,KAAK,YAAY;UACf,IAAI,CAACA,KAAK,CAACE,KAAK,CAACe,IAAI,CAACD,MAAM,CAAChB,KAAK,CAAC;UACnC;MAAM;IAEZ;EAAC;EAAA;AAAA,EArDyCR,cAAc;AAwD1D0B,MAAM,CAACC,OAAO,GAAGvB,6BAA6B"}