{"version":3,"file":"font-xform.js","names":["ColorXform","require","BooleanXform","IntegerXform","StringXform","UnderlineXform","_","BaseXform","FontXform","options","OPTIONS","map","b","prop","xform","tag","attr","i","u","charset","color","condense","extend","family","outline","vertAlign","scheme","shadow","strike","sz","fontNameTag","tagName","xmlStream","model","openNode","each","defn","render","closeNode","node","parser","parseOpen","name","text","parseText","parseClose","item","undefined","module","exports"],"sources":["../../../../../lib/xlsx/xform/style/font-xform.js"],"sourcesContent":["'use strict';\n\nconst ColorXform = require('./color-xform');\nconst BooleanXform = require('../simple/boolean-xform');\nconst IntegerXform = require('../simple/integer-xform');\nconst StringXform = require('../simple/string-xform');\nconst UnderlineXform = require('./underline-xform');\n\nconst _ = require('../../../utils/under-dash');\nconst BaseXform = require('../base-xform');\n\n// Font encapsulates translation from font model to xlsx\nclass FontXform extends BaseXform {\n  constructor(options) {\n    super();\n\n    this.options = options || FontXform.OPTIONS;\n\n    this.map = {\n      b: {prop: 'bold', xform: new BooleanXform({tag: 'b', attr: 'val'})},\n      i: {prop: 'italic', xform: new BooleanXform({tag: 'i', attr: 'val'})},\n      u: {prop: 'underline', xform: new UnderlineXform()},\n      charset: {prop: 'charset', xform: new IntegerXform({tag: 'charset', attr: 'val'})},\n      color: {prop: 'color', xform: new ColorXform()},\n      condense: {prop: 'condense', xform: new BooleanXform({tag: 'condense', attr: 'val'})},\n      extend: {prop: 'extend', xform: new BooleanXform({tag: 'extend', attr: 'val'})},\n      family: {prop: 'family', xform: new IntegerXform({tag: 'family', attr: 'val'})},\n      outline: {prop: 'outline', xform: new BooleanXform({tag: 'outline', attr: 'val'})},\n      vertAlign: {prop: 'vertAlign', xform: new StringXform({tag: 'vertAlign', attr: 'val'})},\n      scheme: {prop: 'scheme', xform: new StringXform({tag: 'scheme', attr: 'val'})},\n      shadow: {prop: 'shadow', xform: new BooleanXform({tag: 'shadow', attr: 'val'})},\n      strike: {prop: 'strike', xform: new BooleanXform({tag: 'strike', attr: 'val'})},\n      sz: {prop: 'size', xform: new IntegerXform({tag: 'sz', attr: 'val'})},\n    };\n    this.map[this.options.fontNameTag] = {\n      prop: 'name',\n      xform: new StringXform({tag: this.options.fontNameTag, attr: 'val'}),\n    };\n  }\n\n  get tag() {\n    return this.options.tagName;\n  }\n\n  render(xmlStream, model) {\n    const {map} = this;\n\n    xmlStream.openNode(this.options.tagName);\n    _.each(this.map, (defn, tag) => {\n      map[tag].xform.render(xmlStream, model[defn.prop]);\n    });\n    xmlStream.closeNode();\n  }\n\n  parseOpen(node) {\n    if (this.parser) {\n      this.parser.parseOpen(node);\n      return true;\n    }\n    if (this.map[node.name]) {\n      this.parser = this.map[node.name].xform;\n      return this.parser.parseOpen(node);\n    }\n    switch (node.name) {\n      case this.options.tagName:\n        this.model = {};\n        return true;\n      default:\n        return false;\n    }\n  }\n\n  parseText(text) {\n    if (this.parser) {\n      this.parser.parseText(text);\n    }\n  }\n\n  parseClose(name) {\n    if (this.parser && !this.parser.parseClose(name)) {\n      const item = this.map[name];\n      if (this.parser.model) {\n        this.model[item.prop] = this.parser.model;\n      }\n      this.parser = undefined;\n      return true;\n    }\n    switch (name) {\n      case this.options.tagName:\n        return false;\n      default:\n        return true;\n    }\n  }\n}\n\nFontXform.OPTIONS = {\n  tagName: 'font',\n  fontNameTag: 'name',\n};\n\nmodule.exports = FontXform;\n"],"mappings":"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"}