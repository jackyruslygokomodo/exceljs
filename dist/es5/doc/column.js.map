{"version":3,"file":"column.js","names":["_","require","Enums","colCache","DEFAULT_COLUMN_WIDTH","Column","worksheet","number","defn","_worksheet","_number","n2l","width","undefined","header","_header","key","style","hidden","outlineLevel","value","_hidden","_key","Array","headers","forEach","text","index","getCell","column","getColumnKey","deleteColumnKey","setColumnKey","_outlineLevel","properties","outlineLevelCol","JSON","stringify","length","other","isEqual","isCustomWidth","s","font","numFmt","alignment","border","fill","protection","options","iteratee","colNumber","eachRow","row","rowNumber","v","eachCell","cell","type","ValueType","Null","offset","hasOwnProperty","name","_applyStyle","columns","cols","col","isDefault","equivalentTo","min","max","collapsed","push","count","module","exports"],"sources":["../../../lib/doc/column.js"],"sourcesContent":["'use strict';\n\nconst _ = require('../utils/under-dash');\n\nconst Enums = require('./enums');\nconst colCache = require('../utils/col-cache');\n\nconst DEFAULT_COLUMN_WIDTH = 9;\n\n// Column defines the column properties for 1 column.\n// This includes header rows, widths, key, (style), etc.\n// Worksheet will condense the columns as appropriate during serialization\nclass Column {\n  constructor(worksheet, number, defn) {\n    this._worksheet = worksheet;\n    this._number = number;\n    if (defn !== false) {\n      // sometimes defn will follow\n      this.defn = defn;\n    }\n  }\n\n  get number() {\n    return this._number;\n  }\n\n  get worksheet() {\n    return this._worksheet;\n  }\n\n  get letter() {\n    return colCache.n2l(this._number);\n  }\n\n  get isCustomWidth() {\n    return this.width !== undefined && this.width !== DEFAULT_COLUMN_WIDTH;\n  }\n\n  get defn() {\n    return {\n      header: this._header,\n      key: this.key,\n      width: this.width,\n      style: this.style,\n      hidden: this.hidden,\n      outlineLevel: this.outlineLevel,\n    };\n  }\n\n  set defn(value) {\n    if (value) {\n      this.key = value.key;\n      this.width = value.width !== undefined ? value.width : DEFAULT_COLUMN_WIDTH;\n      this.outlineLevel = value.outlineLevel;\n      if (value.style) {\n        this.style = value.style;\n      } else {\n        this.style = {};\n      }\n\n      // headers must be set after style\n      this.header = value.header;\n      this._hidden = !!value.hidden;\n    } else {\n      delete this._header;\n      delete this._key;\n      delete this.width;\n      this.style = {};\n      this.outlineLevel = 0;\n    }\n  }\n\n  get headers() {\n    return this._header && this._header instanceof Array ? this._header : [this._header];\n  }\n\n  get header() {\n    return this._header;\n  }\n\n  set header(value) {\n    if (value !== undefined) {\n      this._header = value;\n      this.headers.forEach((text, index) => {\n        this._worksheet.getCell(index + 1, this.number).value = text;\n      });\n    } else {\n      this._header = undefined;\n    }\n  }\n\n  get key() {\n    return this._key;\n  }\n\n  set key(value) {\n    const column = this._key && this._worksheet.getColumnKey(this._key);\n    if (column === this) {\n      this._worksheet.deleteColumnKey(this._key);\n    }\n\n    this._key = value;\n    if (value) {\n      this._worksheet.setColumnKey(this._key, this);\n    }\n  }\n\n  get hidden() {\n    return !!this._hidden;\n  }\n\n  set hidden(value) {\n    this._hidden = value;\n  }\n\n  get outlineLevel() {\n    return this._outlineLevel || 0;\n  }\n\n  set outlineLevel(value) {\n    this._outlineLevel = value;\n  }\n\n  get collapsed() {\n    return !!(\n      this._outlineLevel && this._outlineLevel >= this._worksheet.properties.outlineLevelCol\n    );\n  }\n\n  toString() {\n    return JSON.stringify({\n      key: this.key,\n      width: this.width,\n      headers: this.headers.length ? this.headers : undefined,\n    });\n  }\n\n  equivalentTo(other) {\n    return (\n      this.width === other.width &&\n      this.hidden === other.hidden &&\n      this.outlineLevel === other.outlineLevel &&\n      _.isEqual(this.style, other.style)\n    );\n  }\n\n  get isDefault() {\n    if (this.isCustomWidth) {\n      return false;\n    }\n    if (this.hidden) {\n      return false;\n    }\n    if (this.outlineLevel) {\n      return false;\n    }\n    const s = this.style;\n    if (s && (s.font || s.numFmt || s.alignment || s.border || s.fill || s.protection)) {\n      return false;\n    }\n    return true;\n  }\n\n  get headerCount() {\n    return this.headers.length;\n  }\n\n  eachCell(options, iteratee) {\n    const colNumber = this.number;\n    if (!iteratee) {\n      iteratee = options;\n      options = null;\n    }\n    this._worksheet.eachRow(options, (row, rowNumber) => {\n      iteratee(row.getCell(colNumber), rowNumber);\n    });\n  }\n\n  get values() {\n    const v = [];\n    this.eachCell((cell, rowNumber) => {\n      if (cell && cell.type !== Enums.ValueType.Null) {\n        v[rowNumber] = cell.value;\n      }\n    });\n    return v;\n  }\n\n  set values(v) {\n    if (!v) {\n      return;\n    }\n    const colNumber = this.number;\n    let offset = 0;\n    if (v.hasOwnProperty('0')) {\n      // assume contiguous array, start at row 1\n      offset = 1;\n    }\n    v.forEach((value, index) => {\n      this._worksheet.getCell(index + offset, colNumber).value = value;\n    });\n  }\n\n  // =========================================================================\n  // styles\n  _applyStyle(name, value) {\n    this.style[name] = value;\n    this.eachCell(cell => {\n      cell[name] = value;\n    });\n    return value;\n  }\n\n  get numFmt() {\n    return this.style.numFmt;\n  }\n\n  set numFmt(value) {\n    this._applyStyle('numFmt', value);\n  }\n\n  get font() {\n    return this.style.font;\n  }\n\n  set font(value) {\n    this._applyStyle('font', value);\n  }\n\n  get alignment() {\n    return this.style.alignment;\n  }\n\n  set alignment(value) {\n    this._applyStyle('alignment', value);\n  }\n\n  get protection() {\n    return this.style.protection;\n  }\n\n  set protection(value) {\n    this._applyStyle('protection', value);\n  }\n\n  get border() {\n    return this.style.border;\n  }\n\n  set border(value) {\n    this._applyStyle('border', value);\n  }\n\n  get fill() {\n    return this.style.fill;\n  }\n\n  set fill(value) {\n    this._applyStyle('fill', value);\n  }\n\n  // =============================================================================\n  // static functions\n\n  static toModel(columns) {\n    // Convert array of Column into compressed list cols\n    const cols = [];\n    let col = null;\n    if (columns) {\n      columns.forEach((column, index) => {\n        if (column.isDefault) {\n          if (col) {\n            col = null;\n          }\n        } else if (!col || !column.equivalentTo(col)) {\n          col = {\n            min: index + 1,\n            max: index + 1,\n            width: column.width !== undefined ? column.width : DEFAULT_COLUMN_WIDTH,\n            style: column.style,\n            isCustomWidth: column.isCustomWidth,\n            hidden: column.hidden,\n            outlineLevel: column.outlineLevel,\n            collapsed: column.collapsed,\n          };\n          cols.push(col);\n        } else {\n          col.max = index + 1;\n        }\n      });\n    }\n    return cols.length ? cols : undefined;\n  }\n\n  static fromModel(worksheet, cols) {\n    cols = cols || [];\n    const columns = [];\n    let count = 1;\n    let index = 0;\n    while (index < cols.length) {\n      const col = cols[index++];\n      while (count < col.min) {\n        columns.push(new Column(worksheet, count++));\n      }\n      while (count <= col.max) {\n        columns.push(new Column(worksheet, count++, col));\n      }\n    }\n    return columns.length ? columns : null;\n  }\n}\n\nmodule.exports = Column;\n"],"mappings":"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"}