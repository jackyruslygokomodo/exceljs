{"version":3,"file":"note.js","names":["_","require","Note","note","value","type","texts","text","deepMerge","DEFAULT_CONFIGS","length","Object","keys","model","margins","insetmode","inset","protection","locked","lockText","editAs","module","exports"],"sources":["../../../lib/doc/note.js"],"sourcesContent":["const _ = require('../utils/under-dash');\n\nclass Note {\n  constructor(note) {\n    this.note = note;\n  }\n\n  get model() {\n    let value = null;\n    switch (typeof this.note) {\n      case 'string':\n        value = {\n          type: 'note',\n          note: {\n            texts: [\n              {\n                text: this.note,\n              },\n            ],\n          },\n        };\n        break;\n      default:\n        value = {\n          type: 'note',\n          note: this.note,\n        };\n        break;\n    }\n    // Suitable for all cell comments\n    return _.deepMerge({}, Note.DEFAULT_CONFIGS, value);\n  }\n\n  set model(value) {\n    const {note} = value;\n    const {texts} = note;\n    if (texts.length === 1 && Object.keys(texts[0]).length === 1) {\n      this.note = texts[0].text;\n    } else {\n      this.note = note;\n    }\n  }\n\n  static fromModel(model) {\n    const note = new Note();\n    note.model = model;\n    return note;\n  }\n}\n\nNote.DEFAULT_CONFIGS = {\n  note: {\n    margins: {\n      insetmode: 'auto',\n      inset: [0.13, 0.13, 0.25, 0.25],\n    },\n    protection: {\n      locked: 'True',\n      lockText: 'True',\n    },\n    editAs: 'absolute',\n  },\n};\n\nmodule.exports = Note;\n"],"mappings":";;;;;;;;AAAA,IAAMA,CAAC,GAAGC,OAAO,CAAC,qBAAqB,CAAC;AAAC,IAEnCC,IAAI;EACR,cAAYC,IAAI,EAAE;IAAA;IAChB,IAAI,CAACA,IAAI,GAAGA,IAAI;EAClB;EAAC;IAAA;IAAA,KAED,eAAY;MACV,IAAIC,KAAK,GAAG,IAAI;MAChB,gBAAe,IAAI,CAACD,IAAI;QACtB,KAAK,QAAQ;UACXC,KAAK,GAAG;YACNC,IAAI,EAAE,MAAM;YACZF,IAAI,EAAE;cACJG,KAAK,EAAE,CACL;gBACEC,IAAI,EAAE,IAAI,CAACJ;cACb,CAAC;YAEL;UACF,CAAC;UACD;QACF;UACEC,KAAK,GAAG;YACNC,IAAI,EAAE,MAAM;YACZF,IAAI,EAAE,IAAI,CAACA;UACb,CAAC;UACD;MAAM;MAEV;MACA,OAAOH,CAAC,CAACQ,SAAS,CAAC,CAAC,CAAC,EAAEN,IAAI,CAACO,eAAe,EAAEL,KAAK,CAAC;IACrD,CAAC;IAAA,KAED,aAAUA,KAAK,EAAE;MACf,IAAOD,IAAI,GAAIC,KAAK,CAAbD,IAAI;MACX,IAAOG,KAAK,GAAIH,IAAI,CAAbG,KAAK;MACZ,IAAIA,KAAK,CAACI,MAAM,KAAK,CAAC,IAAIC,MAAM,CAACC,IAAI,CAACN,KAAK,CAAC,CAAC,CAAC,CAAC,CAACI,MAAM,KAAK,CAAC,EAAE;QAC5D,IAAI,CAACP,IAAI,GAAGG,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI;MAC3B,CAAC,MAAM;QACL,IAAI,CAACJ,IAAI,GAAGA,IAAI;MAClB;IACF;EAAC;IAAA;IAAA,OAED,mBAAiBU,KAAK,EAAE;MACtB,IAAMV,IAAI,GAAG,IAAID,IAAI,EAAE;MACvBC,IAAI,CAACU,KAAK,GAAGA,KAAK;MAClB,OAAOV,IAAI;IACb;EAAC;EAAA;AAAA;AAGHD,IAAI,CAACO,eAAe,GAAG;EACrBN,IAAI,EAAE;IACJW,OAAO,EAAE;MACPC,SAAS,EAAE,MAAM;MACjBC,KAAK,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI;IAChC,CAAC;IACDC,UAAU,EAAE;MACVC,MAAM,EAAE,MAAM;MACdC,QAAQ,EAAE;IACZ,CAAC;IACDC,MAAM,EAAE;EACV;AACF,CAAC;AAEDC,MAAM,CAACC,OAAO,GAAGpB,IAAI"}