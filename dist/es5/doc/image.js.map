{"version":3,"file":"image.js","names":["colCache","require","Anchor","Image","worksheet","model","type","imageId","hyperlinks","range","tl","br","ext","editAs","Error","decoded","decode","col","left","row","top","right","bottom","module","exports"],"sources":["../../../lib/doc/image.js"],"sourcesContent":["const colCache = require('../utils/col-cache');\nconst Anchor = require('./anchor');\n\nclass Image {\n  constructor(worksheet, model) {\n    this.worksheet = worksheet;\n    this.model = model;\n  }\n\n  get model() {\n    switch (this.type) {\n      case 'background':\n        return {\n          type: this.type,\n          imageId: this.imageId,\n        };\n      case 'image':\n        return {\n          type: this.type,\n          imageId: this.imageId,\n          hyperlinks: this.range.hyperlinks,\n          range: {\n            tl: this.range.tl.model,\n            br: this.range.br && this.range.br.model,\n            ext: this.range.ext,\n            editAs: this.range.editAs,\n          },\n        };\n      default:\n        throw new Error('Invalid Image Type');\n    }\n  }\n\n  set model({type, imageId, range, hyperlinks}) {\n    this.type = type;\n    this.imageId = imageId;\n\n    if (type === 'image') {\n      if (typeof range === 'string') {\n        const decoded = colCache.decode(range);\n        this.range = {\n          tl: new Anchor(this.worksheet, {col: decoded.left, row: decoded.top}, -1),\n          br: new Anchor(this.worksheet, {col: decoded.right, row: decoded.bottom}, 0),\n          editAs: 'oneCell',\n        };\n      } else {\n        this.range = {\n          tl: new Anchor(this.worksheet, range.tl, 0),\n          br: range.br && new Anchor(this.worksheet, range.br, 0),\n          ext: range.ext,\n          editAs: range.editAs,\n          hyperlinks: hyperlinks || range.hyperlinks,\n        };\n      }\n    }\n  }\n}\n\nmodule.exports = Image;\n"],"mappings":";;;;;;;;AAAA,IAAMA,QAAQ,GAAGC,OAAO,CAAC,oBAAoB,CAAC;AAC9C,IAAMC,MAAM,GAAGD,OAAO,CAAC,UAAU,CAAC;AAAC,IAE7BE,KAAK;EACT,eAAYC,SAAS,EAAEC,KAAK,EAAE;IAAA;IAC5B,IAAI,CAACD,SAAS,GAAGA,SAAS;IAC1B,IAAI,CAACC,KAAK,GAAGA,KAAK;EACpB;EAAC;IAAA;IAAA,KAED,eAAY;MACV,QAAQ,IAAI,CAACC,IAAI;QACf,KAAK,YAAY;UACf,OAAO;YACLA,IAAI,EAAE,IAAI,CAACA,IAAI;YACfC,OAAO,EAAE,IAAI,CAACA;UAChB,CAAC;QACH,KAAK,OAAO;UACV,OAAO;YACLD,IAAI,EAAE,IAAI,CAACA,IAAI;YACfC,OAAO,EAAE,IAAI,CAACA,OAAO;YACrBC,UAAU,EAAE,IAAI,CAACC,KAAK,CAACD,UAAU;YACjCC,KAAK,EAAE;cACLC,EAAE,EAAE,IAAI,CAACD,KAAK,CAACC,EAAE,CAACL,KAAK;cACvBM,EAAE,EAAE,IAAI,CAACF,KAAK,CAACE,EAAE,IAAI,IAAI,CAACF,KAAK,CAACE,EAAE,CAACN,KAAK;cACxCO,GAAG,EAAE,IAAI,CAACH,KAAK,CAACG,GAAG;cACnBC,MAAM,EAAE,IAAI,CAACJ,KAAK,CAACI;YACrB;UACF,CAAC;QACH;UACE,MAAM,IAAIC,KAAK,CAAC,oBAAoB,CAAC;MAAC;IAE5C,CAAC;IAAA,KAED,mBAA8C;MAAA,IAAnCR,IAAI,QAAJA,IAAI;QAAEC,OAAO,QAAPA,OAAO;QAAEE,KAAK,QAALA,KAAK;QAAED,UAAU,QAAVA,UAAU;MACzC,IAAI,CAACF,IAAI,GAAGA,IAAI;MAChB,IAAI,CAACC,OAAO,GAAGA,OAAO;MAEtB,IAAID,IAAI,KAAK,OAAO,EAAE;QACpB,IAAI,OAAOG,KAAK,KAAK,QAAQ,EAAE;UAC7B,IAAMM,OAAO,GAAGf,QAAQ,CAACgB,MAAM,CAACP,KAAK,CAAC;UACtC,IAAI,CAACA,KAAK,GAAG;YACXC,EAAE,EAAE,IAAIR,MAAM,CAAC,IAAI,CAACE,SAAS,EAAE;cAACa,GAAG,EAAEF,OAAO,CAACG,IAAI;cAAEC,GAAG,EAAEJ,OAAO,CAACK;YAAG,CAAC,EAAE,CAAC,CAAC,CAAC;YACzET,EAAE,EAAE,IAAIT,MAAM,CAAC,IAAI,CAACE,SAAS,EAAE;cAACa,GAAG,EAAEF,OAAO,CAACM,KAAK;cAAEF,GAAG,EAAEJ,OAAO,CAACO;YAAM,CAAC,EAAE,CAAC,CAAC;YAC5ET,MAAM,EAAE;UACV,CAAC;QACH,CAAC,MAAM;UACL,IAAI,CAACJ,KAAK,GAAG;YACXC,EAAE,EAAE,IAAIR,MAAM,CAAC,IAAI,CAACE,SAAS,EAAEK,KAAK,CAACC,EAAE,EAAE,CAAC,CAAC;YAC3CC,EAAE,EAAEF,KAAK,CAACE,EAAE,IAAI,IAAIT,MAAM,CAAC,IAAI,CAACE,SAAS,EAAEK,KAAK,CAACE,EAAE,EAAE,CAAC,CAAC;YACvDC,GAAG,EAAEH,KAAK,CAACG,GAAG;YACdC,MAAM,EAAEJ,KAAK,CAACI,MAAM;YACpBL,UAAU,EAAEA,UAAU,IAAIC,KAAK,CAACD;UAClC,CAAC;QACH;MACF;IACF;EAAC;EAAA;AAAA;AAGHe,MAAM,CAACC,OAAO,GAAGrB,KAAK"}