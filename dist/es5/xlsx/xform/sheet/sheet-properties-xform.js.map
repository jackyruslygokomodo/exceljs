{"version":3,"file":"sheet-properties-xform.js","names":["BaseXform","require","ColorXform","PageSetupPropertiesXform","OutlinePropertiesXform","SheetPropertiesXform","map","tabColor","pageSetUpPr","outlinePr","xmlStream","model","addRollback","openNode","inner","render","pageSetup","outlineProperties","closeNode","commit","rollback","node","parser","parseOpen","name","tag","reset","text","parseText","parseClose","undefined","module","exports"],"sources":["../../../../../lib/xlsx/xform/sheet/sheet-properties-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\nconst ColorXform = require('../style/color-xform');\nconst PageSetupPropertiesXform = require('./page-setup-properties-xform');\nconst OutlinePropertiesXform = require('./outline-properties-xform');\n\nclass SheetPropertiesXform extends BaseXform {\n  constructor() {\n    super();\n\n    this.map = {\n      tabColor: new ColorXform('tabColor'),\n      pageSetUpPr: new PageSetupPropertiesXform(),\n      outlinePr: new OutlinePropertiesXform(),\n    };\n  }\n\n  get tag() {\n    return 'sheetPr';\n  }\n\n  render(xmlStream, model) {\n    if (model) {\n      xmlStream.addRollback();\n      xmlStream.openNode('sheetPr');\n\n      let inner = false;\n      inner = this.map.tabColor.render(xmlStream, model.tabColor) || inner;\n      inner = this.map.pageSetUpPr.render(xmlStream, model.pageSetup) || inner;\n      inner = this.map.outlinePr.render(xmlStream, model.outlineProperties) || inner;\n\n      if (inner) {\n        xmlStream.closeNode();\n        xmlStream.commit();\n      } else {\n        xmlStream.rollback();\n      }\n    }\n  }\n\n  parseOpen(node) {\n    if (this.parser) {\n      this.parser.parseOpen(node);\n      return true;\n    }\n    if (node.name === this.tag) {\n      this.reset();\n      return true;\n    }\n    if (this.map[node.name]) {\n      this.parser = this.map[node.name];\n      this.parser.parseOpen(node);\n      return true;\n    }\n    return false;\n  }\n\n  parseText(text) {\n    if (this.parser) {\n      this.parser.parseText(text);\n      return true;\n    }\n    return false;\n  }\n\n  parseClose(name) {\n    if (this.parser) {\n      if (!this.parser.parseClose(name)) {\n        this.parser = undefined;\n      }\n      return true;\n    }\n    if (this.map.tabColor.model || this.map.pageSetUpPr.model || this.map.outlinePr.model) {\n      this.model = {};\n      if (this.map.tabColor.model) {\n        this.model.tabColor = this.map.tabColor.model;\n      }\n      if (this.map.pageSetUpPr.model) {\n        this.model.pageSetup = this.map.pageSetUpPr.model;\n      }\n      if (this.map.outlinePr.model) {\n        this.model.outlineProperties = this.map.outlinePr.model;\n      }\n    } else {\n      this.model = null;\n    }\n    return false;\n  }\n}\n\nmodule.exports = SheetPropertiesXform;\n"],"mappings":"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"}