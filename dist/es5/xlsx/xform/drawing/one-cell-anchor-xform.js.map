{"version":3,"file":"one-cell-anchor-xform.js","names":["BaseCellAnchorXform","require","StaticXform","CellPositionXform","ExtXform","PicXform","OneCellAnchorXform","map","tag","model","options","prepare","picture","xmlStream","openNode","editAs","range","render","tl","ext","closeNode","name","parser","parseClose","undefined","medium","reconcilePicture","module","exports"],"sources":["../../../../../lib/xlsx/xform/drawing/one-cell-anchor-xform.js"],"sourcesContent":["const BaseCellAnchorXform = require('./base-cell-anchor-xform');\nconst StaticXform = require('../static-xform');\n\nconst CellPositionXform = require('./cell-position-xform');\nconst ExtXform = require('./ext-xform');\nconst PicXform = require('./pic-xform');\n\nclass OneCellAnchorXform extends BaseCellAnchorXform {\n  constructor() {\n    super();\n\n    this.map = {\n      'xdr:from': new CellPositionXform({tag: 'xdr:from'}),\n      'xdr:ext': new ExtXform({tag: 'xdr:ext'}),\n      'xdr:pic': new PicXform(),\n      'xdr:clientData': new StaticXform({tag: 'xdr:clientData'}),\n    };\n  }\n\n  get tag() {\n    return 'xdr:oneCellAnchor';\n  }\n\n  prepare(model, options) {\n    this.map['xdr:pic'].prepare(model.picture, options);\n  }\n\n  render(xmlStream, model) {\n    xmlStream.openNode(this.tag, {editAs: model.range.editAs || 'oneCell'});\n\n    this.map['xdr:from'].render(xmlStream, model.range.tl);\n    this.map['xdr:ext'].render(xmlStream, model.range.ext);\n    this.map['xdr:pic'].render(xmlStream, model.picture);\n    this.map['xdr:clientData'].render(xmlStream, {});\n\n    xmlStream.closeNode();\n  }\n\n  parseClose(name) {\n    if (this.parser) {\n      if (!this.parser.parseClose(name)) {\n        this.parser = undefined;\n      }\n      return true;\n    }\n    switch (name) {\n      case this.tag:\n        this.model.range.tl = this.map['xdr:from'].model;\n        this.model.range.ext = this.map['xdr:ext'].model;\n        this.model.picture = this.map['xdr:pic'].model;\n        return false;\n      default:\n        // could be some unrecognised tags\n        return true;\n    }\n  }\n\n  reconcile(model, options) {\n    model.medium = this.reconcilePicture(model.picture, options);\n  }\n}\n\nmodule.exports = OneCellAnchorXform;\n"],"mappings":"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"}