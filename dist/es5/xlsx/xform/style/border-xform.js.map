{"version":3,"file":"border-xform.js","names":["BaseXform","require","utils","ColorXform","EdgeXform","name","map","color","xmlStream","model","defaultColor","openNode","style","addAttribute","render","closeNode","node","parser","parseOpen","attributes","undefined","text","parseText","parseClose","value","validStyleValues","reduce","p","v","BorderXform","top","left","bottom","right","diagonal","up","down","add","edgeModel","edgeXform","reset","diagonalUp","parseBoolean","diagonalDown","key","extensions","Object","assign","module","exports"],"sources":["../../../../../lib/xlsx/xform/style/border-xform.js"],"sourcesContent":["/* eslint-disable max-classes-per-file */\nconst BaseXform = require('../base-xform');\nconst utils = require('../../../utils/utils');\n\nconst ColorXform = require('./color-xform');\n\nclass EdgeXform extends BaseXform {\n  constructor(name) {\n    super();\n\n    this.name = name;\n    this.map = {\n      color: new ColorXform(),\n    };\n  }\n\n  get tag() {\n    return this.name;\n  }\n\n  render(xmlStream, model, defaultColor) {\n    const color = (model && model.color) || defaultColor || this.defaultColor;\n    xmlStream.openNode(this.name);\n    if (model && model.style) {\n      xmlStream.addAttribute('style', model.style);\n      if (color) {\n        this.map.color.render(xmlStream, color);\n      }\n    }\n    xmlStream.closeNode();\n  }\n\n  parseOpen(node) {\n    if (this.parser) {\n      this.parser.parseOpen(node);\n      return true;\n    }\n    switch (node.name) {\n      case this.name: {\n        const {style} = node.attributes;\n        if (style) {\n          this.model = {\n            style,\n          };\n        } else {\n          this.model = undefined;\n        }\n        return true;\n      }\n      case 'color':\n        this.parser = this.map.color;\n        this.parser.parseOpen(node);\n        return true;\n      default:\n        return false;\n    }\n  }\n\n  parseText(text) {\n    if (this.parser) {\n      this.parser.parseText(text);\n    }\n  }\n\n  parseClose(name) {\n    if (this.parser) {\n      if (!this.parser.parseClose(name)) {\n        this.parser = undefined;\n      }\n      return true;\n    }\n\n    if (name === this.name) {\n      if (this.map.color.model) {\n        if (!this.model) {\n          this.model = {};\n        }\n        this.model.color = this.map.color.model;\n      }\n    }\n\n    return false;\n  }\n\n  validStyle(value) {\n    return EdgeXform.validStyleValues[value];\n  }\n}\n\nEdgeXform.validStyleValues = [\n  'thin',\n  'dotted',\n  'dashDot',\n  'hair',\n  'dashDotDot',\n  'slantDashDot',\n  'mediumDashed',\n  'mediumDashDotDot',\n  'mediumDashDot',\n  'medium',\n  'double',\n  'thick',\n].reduce((p, v) => {\n  p[v] = true;\n  return p;\n}, {});\n\n// Border encapsulates translation from border model to/from xlsx\nclass BorderXform extends BaseXform {\n  constructor() {\n    super();\n\n    this.map = {\n      top: new EdgeXform('top'),\n      left: new EdgeXform('left'),\n      bottom: new EdgeXform('bottom'),\n      right: new EdgeXform('right'),\n      diagonal: new EdgeXform('diagonal'),\n    };\n  }\n\n  render(xmlStream, model) {\n    const {color} = model;\n    xmlStream.openNode('border');\n    if (model.diagonal && model.diagonal.style) {\n      if (model.diagonal.up) {\n        xmlStream.addAttribute('diagonalUp', '1');\n      }\n      if (model.diagonal.down) {\n        xmlStream.addAttribute('diagonalDown', '1');\n      }\n    }\n    function add(edgeModel, edgeXform) {\n      if (edgeModel && !edgeModel.color && model.color) {\n        // don't mess with incoming models\n        edgeModel = {\n          ...edgeModel,\n          color: model.color,\n        };\n      }\n      edgeXform.render(xmlStream, edgeModel, color);\n    }\n    add(model.left, this.map.left);\n    add(model.right, this.map.right);\n    add(model.top, this.map.top);\n    add(model.bottom, this.map.bottom);\n    add(model.diagonal, this.map.diagonal);\n\n    xmlStream.closeNode();\n  }\n\n  parseOpen(node) {\n    if (this.parser) {\n      this.parser.parseOpen(node);\n      return true;\n    }\n    switch (node.name) {\n      case 'border':\n        this.reset();\n        this.diagonalUp = utils.parseBoolean(node.attributes.diagonalUp);\n        this.diagonalDown = utils.parseBoolean(node.attributes.diagonalDown);\n        return true;\n      default:\n        this.parser = this.map[node.name];\n        if (this.parser) {\n          this.parser.parseOpen(node);\n          return true;\n        }\n        return false;\n    }\n  }\n\n  parseText(text) {\n    if (this.parser) {\n      this.parser.parseText(text);\n    }\n  }\n\n  parseClose(name) {\n    if (this.parser) {\n      if (!this.parser.parseClose(name)) {\n        this.parser = undefined;\n      }\n      return true;\n    }\n    if (name === 'border') {\n      const model = (this.model = {});\n      const add = function(key, edgeModel, extensions) {\n        if (edgeModel) {\n          if (extensions) {\n            Object.assign(edgeModel, extensions);\n          }\n          model[key] = edgeModel;\n        }\n      };\n      add('left', this.map.left.model);\n      add('right', this.map.right.model);\n      add('top', this.map.top.model);\n      add('bottom', this.map.bottom.model);\n      add('diagonal', this.map.diagonal.model, {up: this.diagonalUp, down: this.diagonalDown});\n    }\n    return false;\n  }\n}\n\nmodule.exports = BorderXform;\n"],"mappings":"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"}