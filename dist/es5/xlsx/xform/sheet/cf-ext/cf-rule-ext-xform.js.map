{"version":3,"file":"cf-rule-ext-xform.js","names":["require","uuidv4","v4","BaseXform","CompositeXform","DatabarExtXform","IconSetExtXform","extIcons","CfRuleExtXform","map","databarXform","iconSetXform","model","isExt","x14Id","toUpperCase","xmlStream","type","renderDataBar","renderIconSet","openNode","tag","id","render","closeNode","priority","attributes","toIntValue","name","parser","Object","assign","rule","custom","iconSet","module","exports"],"sources":["../../../../../../lib/xlsx/xform/sheet/cf-ext/cf-rule-ext-xform.js"],"sourcesContent":["const {v4: uuidv4} = require('uuid');\nconst BaseXform = require('../../base-xform');\nconst CompositeXform = require('../../composite-xform');\n\nconst DatabarExtXform = require('./databar-ext-xform');\nconst IconSetExtXform = require('./icon-set-ext-xform');\n\nconst extIcons = {\n  '3Triangles': true,\n  '3Stars': true,\n  '5Boxes': true,\n};\n\nclass CfRuleExtXform extends CompositeXform {\n  constructor() {\n    super();\n\n    this.map = {\n      'x14:dataBar': (this.databarXform = new DatabarExtXform()),\n      'x14:iconSet': (this.iconSetXform = new IconSetExtXform()),\n    };\n  }\n\n  get tag() {\n    return 'x14:cfRule';\n  }\n\n  static isExt(rule) {\n    // is this rule primitive?\n    if (rule.type === 'dataBar') {\n      return DatabarExtXform.isExt(rule);\n    }\n    if (rule.type === 'iconSet') {\n      if (rule.custom || extIcons[rule.iconSet]) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  prepare(model) {\n    if (CfRuleExtXform.isExt(model)) {\n      model.x14Id = `{${uuidv4()}}`.toUpperCase();\n    }\n  }\n\n  render(xmlStream, model) {\n    if (!CfRuleExtXform.isExt(model)) {\n      return;\n    }\n\n    switch (model.type) {\n      case 'dataBar':\n        this.renderDataBar(xmlStream, model);\n        break;\n      case 'iconSet':\n        this.renderIconSet(xmlStream, model);\n        break;\n    }\n  }\n\n  renderDataBar(xmlStream, model) {\n    xmlStream.openNode(this.tag, {\n      type: 'dataBar',\n      id: model.x14Id,\n    });\n\n    this.databarXform.render(xmlStream, model);\n\n    xmlStream.closeNode();\n  }\n\n  renderIconSet(xmlStream, model) {\n    xmlStream.openNode(this.tag, {\n      type: 'iconSet',\n      priority: model.priority,\n      id: model.x14Id || `{${uuidv4()}}`,\n    });\n\n    this.iconSetXform.render(xmlStream, model);\n\n    xmlStream.closeNode();\n  }\n\n  createNewModel({attributes}) {\n    return {\n      type: attributes.type,\n      x14Id: attributes.id,\n      priority: BaseXform.toIntValue(attributes.priority),\n    };\n  }\n\n  onParserClose(name, parser) {\n    Object.assign(this.model, parser.model);\n  }\n}\n\nmodule.exports = CfRuleExtXform;\n"],"mappings":";;;;;;;;;;;;;;;AAAA,eAAqBA,OAAO,CAAC,MAAM,CAAC;EAAzBC,MAAM,YAAVC,EAAE;AACT,IAAMC,SAAS,GAAGH,OAAO,CAAC,kBAAkB,CAAC;AAC7C,IAAMI,cAAc,GAAGJ,OAAO,CAAC,uBAAuB,CAAC;AAEvD,IAAMK,eAAe,GAAGL,OAAO,CAAC,qBAAqB,CAAC;AACtD,IAAMM,eAAe,GAAGN,OAAO,CAAC,sBAAsB,CAAC;AAEvD,IAAMO,QAAQ,GAAG;EACf,YAAY,EAAE,IAAI;EAClB,QAAQ,EAAE,IAAI;EACd,QAAQ,EAAE;AACZ,CAAC;AAAC,IAEIC,cAAc;EAAA;EAAA;EAClB,0BAAc;IAAA;IAAA;IACZ;IAEA,MAAKC,GAAG,GAAG;MACT,aAAa,EAAG,MAAKC,YAAY,GAAG,IAAIL,eAAe,EAAG;MAC1D,aAAa,EAAG,MAAKM,YAAY,GAAG,IAAIL,eAAe;IACzD,CAAC;IAAC;EACJ;EAAC;IAAA;IAAA,KAED,eAAU;MACR,OAAO,YAAY;IACrB;EAAC;IAAA;IAAA,OAeD,iBAAQM,KAAK,EAAE;MACb,IAAIJ,cAAc,CAACK,KAAK,CAACD,KAAK,CAAC,EAAE;QAC/BA,KAAK,CAACE,KAAK,GAAG,WAAIb,MAAM,EAAE,OAAIc,WAAW,EAAE;MAC7C;IACF;EAAC;IAAA;IAAA,OAED,gBAAOC,SAAS,EAAEJ,KAAK,EAAE;MACvB,IAAI,CAACJ,cAAc,CAACK,KAAK,CAACD,KAAK,CAAC,EAAE;QAChC;MACF;MAEA,QAAQA,KAAK,CAACK,IAAI;QAChB,KAAK,SAAS;UACZ,IAAI,CAACC,aAAa,CAACF,SAAS,EAAEJ,KAAK,CAAC;UACpC;QACF,KAAK,SAAS;UACZ,IAAI,CAACO,aAAa,CAACH,SAAS,EAAEJ,KAAK,CAAC;UACpC;MAAM;IAEZ;EAAC;IAAA;IAAA,OAED,uBAAcI,SAAS,EAAEJ,KAAK,EAAE;MAC9BI,SAAS,CAACI,QAAQ,CAAC,IAAI,CAACC,GAAG,EAAE;QAC3BJ,IAAI,EAAE,SAAS;QACfK,EAAE,EAAEV,KAAK,CAACE;MACZ,CAAC,CAAC;MAEF,IAAI,CAACJ,YAAY,CAACa,MAAM,CAACP,SAAS,EAAEJ,KAAK,CAAC;MAE1CI,SAAS,CAACQ,SAAS,EAAE;IACvB;EAAC;IAAA;IAAA,OAED,uBAAcR,SAAS,EAAEJ,KAAK,EAAE;MAC9BI,SAAS,CAACI,QAAQ,CAAC,IAAI,CAACC,GAAG,EAAE;QAC3BJ,IAAI,EAAE,SAAS;QACfQ,QAAQ,EAAEb,KAAK,CAACa,QAAQ;QACxBH,EAAE,EAAEV,KAAK,CAACE,KAAK,eAAQb,MAAM,EAAE;MACjC,CAAC,CAAC;MAEF,IAAI,CAACU,YAAY,CAACY,MAAM,CAACP,SAAS,EAAEJ,KAAK,CAAC;MAE1CI,SAAS,CAACQ,SAAS,EAAE;IACvB;EAAC;IAAA;IAAA,OAED,8BAA6B;MAAA,IAAbE,UAAU,QAAVA,UAAU;MACxB,OAAO;QACLT,IAAI,EAAES,UAAU,CAACT,IAAI;QACrBH,KAAK,EAAEY,UAAU,CAACJ,EAAE;QACpBG,QAAQ,EAAEtB,SAAS,CAACwB,UAAU,CAACD,UAAU,CAACD,QAAQ;MACpD,CAAC;IACH;EAAC;IAAA;IAAA,OAED,uBAAcG,IAAI,EAAEC,MAAM,EAAE;MAC1BC,MAAM,CAACC,MAAM,CAAC,IAAI,CAACnB,KAAK,EAAEiB,MAAM,CAACjB,KAAK,CAAC;IACzC;EAAC;IAAA;IAAA,OAnED,eAAaoB,IAAI,EAAE;MACjB;MACA,IAAIA,IAAI,CAACf,IAAI,KAAK,SAAS,EAAE;QAC3B,OAAOZ,eAAe,CAACQ,KAAK,CAACmB,IAAI,CAAC;MACpC;MACA,IAAIA,IAAI,CAACf,IAAI,KAAK,SAAS,EAAE;QAC3B,IAAIe,IAAI,CAACC,MAAM,IAAI1B,QAAQ,CAACyB,IAAI,CAACE,OAAO,CAAC,EAAE;UACzC,OAAO,IAAI;QACb;MACF;MACA,OAAO,KAAK;IACd;EAAC;EAAA;AAAA,EAzB0B9B,cAAc;AAoF3C+B,MAAM,CAACC,OAAO,GAAG5B,cAAc"}