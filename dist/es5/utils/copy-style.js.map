{"version":3,"file":"copy-style.js","names":["oneDepthCopy","obj","nestKeys","reduce","memo","key","setIfExists","src","dst","isEmptyObj","Object","keys","length","copyStyle","style","copied","border","fill","stops","map","s","exports"],"sources":["../../../lib/utils/copy-style.js"],"sourcesContent":["const oneDepthCopy = (obj, nestKeys) => ({\n  ...obj,\n  ...nestKeys.reduce((memo, key) => {\n    if (obj[key]) memo[key] = {...obj[key]};\n    return memo;\n  }, {}),\n});\n\nconst setIfExists = (src, dst, key, nestKeys = []) => {\n  if (src[key]) dst[key] = oneDepthCopy(src[key], nestKeys);\n};\n\nconst isEmptyObj = obj => Object.keys(obj).length === 0;\n\nconst copyStyle = style => {\n  if (!style) return style;\n  if (isEmptyObj(style)) return {};\n\n  const copied = {...style};\n\n  setIfExists(style, copied, 'font', ['color']);\n  setIfExists(style, copied, 'alignment');\n  setIfExists(style, copied, 'protection');\n  if (style.border) {\n    setIfExists(style, copied, 'border');\n    setIfExists(style.border, copied.border, 'top', ['color']);\n    setIfExists(style.border, copied.border, 'left', ['color']);\n    setIfExists(style.border, copied.border, 'bottom', ['color']);\n    setIfExists(style.border, copied.border, 'right', ['color']);\n    setIfExists(style.border, copied.border, 'diagonal', ['color']);\n  }\n\n  if (style.fill) {\n    setIfExists(style, copied, 'fill', ['fgColor', 'bgColor', 'center']);\n    if (style.fill.stops) {\n      copied.fill.stops = style.fill.stops.map(s => oneDepthCopy(s, ['color']));\n    }\n  }\n\n  return copied;\n};\n\nexports.copyStyle = copyStyle;\n"],"mappings":";;;;;;;;AAAA,IAAMA,YAAY,GAAG,SAAfA,YAAY,CAAIC,GAAG,EAAEC,QAAQ;EAAA,uCAC9BD,GAAG,GACHC,QAAQ,CAACC,MAAM,CAAC,UAACC,IAAI,EAAEC,GAAG,EAAK;IAChC,IAAIJ,GAAG,CAACI,GAAG,CAAC,EAAED,IAAI,CAACC,GAAG,CAAC,qBAAOJ,GAAG,CAACI,GAAG,CAAC,CAAC;IACvC,OAAOD,IAAI;EACb,CAAC,EAAE,CAAC,CAAC,CAAC;AAAA,CACN;AAEF,IAAME,WAAW,GAAG,SAAdA,WAAW,CAAIC,GAAG,EAAEC,GAAG,EAAEH,GAAG,EAAoB;EAAA,IAAlBH,QAAQ,uEAAG,EAAE;EAC/C,IAAIK,GAAG,CAACF,GAAG,CAAC,EAAEG,GAAG,CAACH,GAAG,CAAC,GAAGL,YAAY,CAACO,GAAG,CAACF,GAAG,CAAC,EAAEH,QAAQ,CAAC;AAC3D,CAAC;AAED,IAAMO,UAAU,GAAG,SAAbA,UAAU,CAAGR,GAAG;EAAA,OAAIS,MAAM,CAACC,IAAI,CAACV,GAAG,CAAC,CAACW,MAAM,KAAK,CAAC;AAAA;AAEvD,IAAMC,SAAS,GAAG,SAAZA,SAAS,CAAGC,KAAK,EAAI;EACzB,IAAI,CAACA,KAAK,EAAE,OAAOA,KAAK;EACxB,IAAIL,UAAU,CAACK,KAAK,CAAC,EAAE,OAAO,CAAC,CAAC;EAEhC,IAAMC,MAAM,qBAAOD,KAAK,CAAC;EAEzBR,WAAW,CAACQ,KAAK,EAAEC,MAAM,EAAE,MAAM,EAAE,CAAC,OAAO,CAAC,CAAC;EAC7CT,WAAW,CAACQ,KAAK,EAAEC,MAAM,EAAE,WAAW,CAAC;EACvCT,WAAW,CAACQ,KAAK,EAAEC,MAAM,EAAE,YAAY,CAAC;EACxC,IAAID,KAAK,CAACE,MAAM,EAAE;IAChBV,WAAW,CAACQ,KAAK,EAAEC,MAAM,EAAE,QAAQ,CAAC;IACpCT,WAAW,CAACQ,KAAK,CAACE,MAAM,EAAED,MAAM,CAACC,MAAM,EAAE,KAAK,EAAE,CAAC,OAAO,CAAC,CAAC;IAC1DV,WAAW,CAACQ,KAAK,CAACE,MAAM,EAAED,MAAM,CAACC,MAAM,EAAE,MAAM,EAAE,CAAC,OAAO,CAAC,CAAC;IAC3DV,WAAW,CAACQ,KAAK,CAACE,MAAM,EAAED,MAAM,CAACC,MAAM,EAAE,QAAQ,EAAE,CAAC,OAAO,CAAC,CAAC;IAC7DV,WAAW,CAACQ,KAAK,CAACE,MAAM,EAAED,MAAM,CAACC,MAAM,EAAE,OAAO,EAAE,CAAC,OAAO,CAAC,CAAC;IAC5DV,WAAW,CAACQ,KAAK,CAACE,MAAM,EAAED,MAAM,CAACC,MAAM,EAAE,UAAU,EAAE,CAAC,OAAO,CAAC,CAAC;EACjE;EAEA,IAAIF,KAAK,CAACG,IAAI,EAAE;IACdX,WAAW,CAACQ,KAAK,EAAEC,MAAM,EAAE,MAAM,EAAE,CAAC,SAAS,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAC;IACpE,IAAID,KAAK,CAACG,IAAI,CAACC,KAAK,EAAE;MACpBH,MAAM,CAACE,IAAI,CAACC,KAAK,GAAGJ,KAAK,CAACG,IAAI,CAACC,KAAK,CAACC,GAAG,CAAC,UAAAC,CAAC;QAAA,OAAIpB,YAAY,CAACoB,CAAC,EAAE,CAAC,OAAO,CAAC,CAAC;MAAA,EAAC;IAC3E;EACF;EAEA,OAAOL,MAAM;AACf,CAAC;AAEDM,OAAO,CAACR,SAAS,GAAGA,SAAS"}