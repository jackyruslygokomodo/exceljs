{"version":3,"file":"protection-xform.js","names":["BaseXform","require","validation","boolean","value","dflt","undefined","ProtectionXform","xmlStream","model","addRollback","openNode","isValid","add","name","addAttribute","locked","hidden","closeNode","commit","rollback","node","attributes","isSignificant","module","exports"],"sources":["../../../../../lib/xlsx/xform/style/protection-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\n\nconst validation = {\n  boolean(value, dflt) {\n    if (value === undefined) {\n      return dflt;\n    }\n    return value;\n  },\n};\n\n// Protection encapsulates translation from style.protection model to/from xlsx\nclass ProtectionXform extends BaseXform {\n  get tag() {\n    return 'protection';\n  }\n\n  render(xmlStream, model) {\n    xmlStream.addRollback();\n    xmlStream.openNode('protection');\n\n    let isValid = false;\n    function add(name, value) {\n      if (value !== undefined) {\n        xmlStream.addAttribute(name, value);\n        isValid = true;\n      }\n    }\n    add('locked', validation.boolean(model.locked, true) ? undefined : '0');\n    add('hidden', validation.boolean(model.hidden, false) ? '1' : undefined);\n\n    xmlStream.closeNode();\n\n    if (isValid) {\n      xmlStream.commit();\n    } else {\n      xmlStream.rollback();\n    }\n  }\n\n  parseOpen(node) {\n    const model = {\n      locked: !(node.attributes.locked === '0'),\n      hidden: node.attributes.hidden === '1',\n    };\n\n    // only want to record models that differ from defaults\n    const isSignificant = !model.locked || model.hidden;\n\n    this.model = isSignificant ? model : null;\n  }\n\n  parseText() {}\n\n  parseClose() {\n    return false;\n  }\n}\n\nmodule.exports = ProtectionXform;\n"],"mappings":";;;;;;;;;;;;;;;AAAA,IAAMA,SAAS,GAAGC,OAAO,CAAC,eAAe,CAAC;AAE1C,IAAMC,UAAU,GAAG;EACjBC,OAAO,mBAACC,KAAK,EAAEC,IAAI,EAAE;IACnB,IAAID,KAAK,KAAKE,SAAS,EAAE;MACvB,OAAOD,IAAI;IACb;IACA,OAAOD,KAAK;EACd;AACF,CAAC;;AAED;AAAA,IACMG,eAAe;EAAA;EAAA;EAAA;IAAA;IAAA;EAAA;EAAA;IAAA;IAAA,KACnB,eAAU;MACR,OAAO,YAAY;IACrB;EAAC;IAAA;IAAA,OAED,gBAAOC,SAAS,EAAEC,KAAK,EAAE;MACvBD,SAAS,CAACE,WAAW,EAAE;MACvBF,SAAS,CAACG,QAAQ,CAAC,YAAY,CAAC;MAEhC,IAAIC,OAAO,GAAG,KAAK;MACnB,SAASC,GAAG,CAACC,IAAI,EAAEV,KAAK,EAAE;QACxB,IAAIA,KAAK,KAAKE,SAAS,EAAE;UACvBE,SAAS,CAACO,YAAY,CAACD,IAAI,EAAEV,KAAK,CAAC;UACnCQ,OAAO,GAAG,IAAI;QAChB;MACF;MACAC,GAAG,CAAC,QAAQ,EAAEX,UAAU,CAACC,OAAO,CAACM,KAAK,CAACO,MAAM,EAAE,IAAI,CAAC,GAAGV,SAAS,GAAG,GAAG,CAAC;MACvEO,GAAG,CAAC,QAAQ,EAAEX,UAAU,CAACC,OAAO,CAACM,KAAK,CAACQ,MAAM,EAAE,KAAK,CAAC,GAAG,GAAG,GAAGX,SAAS,CAAC;MAExEE,SAAS,CAACU,SAAS,EAAE;MAErB,IAAIN,OAAO,EAAE;QACXJ,SAAS,CAACW,MAAM,EAAE;MACpB,CAAC,MAAM;QACLX,SAAS,CAACY,QAAQ,EAAE;MACtB;IACF;EAAC;IAAA;IAAA,OAED,mBAAUC,IAAI,EAAE;MACd,IAAMZ,KAAK,GAAG;QACZO,MAAM,EAAE,EAAEK,IAAI,CAACC,UAAU,CAACN,MAAM,KAAK,GAAG,CAAC;QACzCC,MAAM,EAAEI,IAAI,CAACC,UAAU,CAACL,MAAM,KAAK;MACrC,CAAC;;MAED;MACA,IAAMM,aAAa,GAAG,CAACd,KAAK,CAACO,MAAM,IAAIP,KAAK,CAACQ,MAAM;MAEnD,IAAI,CAACR,KAAK,GAAGc,aAAa,GAAGd,KAAK,GAAG,IAAI;IAC3C;EAAC;IAAA;IAAA,OAED,qBAAY,CAAC;EAAC;IAAA;IAAA,OAEd,sBAAa;MACX,OAAO,KAAK;IACd;EAAC;EAAA;AAAA,EA5C2BT,SAAS;AA+CvCwB,MAAM,CAACC,OAAO,GAAGlB,eAAe"}