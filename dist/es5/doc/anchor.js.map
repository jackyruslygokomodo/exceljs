{"version":3,"file":"anchor.js","names":["colCache","require","Anchor","worksheet","address","offset","nativeCol","nativeColOff","nativeRow","nativeRowOff","decoded","decodeAddress","col","row","undefined","Math","min","colWidth","v","floor","rowHeight","getColumn","isCustomWidth","width","getRow","height","value","model","module","exports"],"sources":["../../../lib/doc/anchor.js"],"sourcesContent":["'use strict';\n\nconst colCache = require('../utils/col-cache');\n\nclass Anchor {\n  constructor(worksheet, address, offset = 0) {\n    if (!address) {\n      this.nativeCol = 0;\n      this.nativeColOff = 0;\n      this.nativeRow = 0;\n      this.nativeRowOff = 0;\n    } else if (typeof address === 'string') {\n      const decoded = colCache.decodeAddress(address);\n      this.nativeCol = decoded.col + offset;\n      this.nativeColOff = 0;\n      this.nativeRow = decoded.row + offset;\n      this.nativeRowOff = 0;\n    } else if (address.nativeCol !== undefined) {\n      this.nativeCol = address.nativeCol || 0;\n      this.nativeColOff = address.nativeColOff || 0;\n      this.nativeRow = address.nativeRow || 0;\n      this.nativeRowOff = address.nativeRowOff || 0;\n    } else if (address.col !== undefined) {\n      this.col = address.col + offset;\n      this.row = address.row + offset;\n    } else {\n      this.nativeCol = 0;\n      this.nativeColOff = 0;\n      this.nativeRow = 0;\n      this.nativeRowOff = 0;\n    }\n\n    this.worksheet = worksheet;\n  }\n\n  static asInstance(model) {\n    return model instanceof Anchor || model == null ? model : new Anchor(model);\n  }\n\n  get col() {\n    return this.nativeCol + (Math.min(this.colWidth - 1, this.nativeColOff) / this.colWidth);\n  }\n\n  set col(v) {\n    this.nativeCol = Math.floor(v);\n    this.nativeColOff = Math.floor((v - this.nativeCol) * this.colWidth);\n  }\n\n  get row() {\n    return this.nativeRow + (Math.min(this.rowHeight - 1, this.nativeRowOff) / this.rowHeight);\n  }\n\n  set row(v) {\n    this.nativeRow = Math.floor(v);\n    this.nativeRowOff = Math.floor((v - this.nativeRow) * this.rowHeight);\n  }\n\n  get colWidth() {\n    return this.worksheet &&\n      this.worksheet.getColumn(this.nativeCol + 1) &&\n      this.worksheet.getColumn(this.nativeCol + 1).isCustomWidth\n      ? Math.floor(this.worksheet.getColumn(this.nativeCol + 1).width * 10000)\n      : 640000;\n  }\n\n  get rowHeight() {\n    return this.worksheet &&\n      this.worksheet.getRow(this.nativeRow + 1) &&\n      this.worksheet.getRow(this.nativeRow + 1).height\n      ? Math.floor(this.worksheet.getRow(this.nativeRow + 1).height * 10000)\n      : 180000;\n  }\n\n  get model() {\n    return {\n      nativeCol: this.nativeCol,\n      nativeColOff: this.nativeColOff,\n      nativeRow: this.nativeRow,\n      nativeRowOff: this.nativeRowOff,\n    };\n  }\n\n  set model(value) {\n    this.nativeCol = value.nativeCol;\n    this.nativeColOff = value.nativeColOff;\n    this.nativeRow = value.nativeRow;\n    this.nativeRowOff = value.nativeRowOff;\n  }\n}\n\nmodule.exports = Anchor;\n"],"mappings":"AAAA,YAAY;;AAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAEb,IAAMA,QAAQ,GAAGC,OAAO,CAAC,oBAAoB,CAAC;AAAC,IAEzCC,MAAM;EACV,gBAAYC,SAAS,EAAEC,OAAO,EAAc;IAAA,IAAZC,MAAM,uEAAG,CAAC;IAAA;IACxC,IAAI,CAACD,OAAO,EAAE;MACZ,IAAI,CAACE,SAAS,GAAG,CAAC;MAClB,IAAI,CAACC,YAAY,GAAG,CAAC;MACrB,IAAI,CAACC,SAAS,GAAG,CAAC;MAClB,IAAI,CAACC,YAAY,GAAG,CAAC;IACvB,CAAC,MAAM,IAAI,OAAOL,OAAO,KAAK,QAAQ,EAAE;MACtC,IAAMM,OAAO,GAAGV,QAAQ,CAACW,aAAa,CAACP,OAAO,CAAC;MAC/C,IAAI,CAACE,SAAS,GAAGI,OAAO,CAACE,GAAG,GAAGP,MAAM;MACrC,IAAI,CAACE,YAAY,GAAG,CAAC;MACrB,IAAI,CAACC,SAAS,GAAGE,OAAO,CAACG,GAAG,GAAGR,MAAM;MACrC,IAAI,CAACI,YAAY,GAAG,CAAC;IACvB,CAAC,MAAM,IAAIL,OAAO,CAACE,SAAS,KAAKQ,SAAS,EAAE;MAC1C,IAAI,CAACR,SAAS,GAAGF,OAAO,CAACE,SAAS,IAAI,CAAC;MACvC,IAAI,CAACC,YAAY,GAAGH,OAAO,CAACG,YAAY,IAAI,CAAC;MAC7C,IAAI,CAACC,SAAS,GAAGJ,OAAO,CAACI,SAAS,IAAI,CAAC;MACvC,IAAI,CAACC,YAAY,GAAGL,OAAO,CAACK,YAAY,IAAI,CAAC;IAC/C,CAAC,MAAM,IAAIL,OAAO,CAACQ,GAAG,KAAKE,SAAS,EAAE;MACpC,IAAI,CAACF,GAAG,GAAGR,OAAO,CAACQ,GAAG,GAAGP,MAAM;MAC/B,IAAI,CAACQ,GAAG,GAAGT,OAAO,CAACS,GAAG,GAAGR,MAAM;IACjC,CAAC,MAAM;MACL,IAAI,CAACC,SAAS,GAAG,CAAC;MAClB,IAAI,CAACC,YAAY,GAAG,CAAC;MACrB,IAAI,CAACC,SAAS,GAAG,CAAC;MAClB,IAAI,CAACC,YAAY,GAAG,CAAC;IACvB;IAEA,IAAI,CAACN,SAAS,GAAGA,SAAS;EAC5B;EAAC;IAAA;IAAA,KAMD,eAAU;MACR,OAAO,IAAI,CAACG,SAAS,GAAIS,IAAI,CAACC,GAAG,CAAC,IAAI,CAACC,QAAQ,GAAG,CAAC,EAAE,IAAI,CAACV,YAAY,CAAC,GAAG,IAAI,CAACU,QAAS;IAC1F,CAAC;IAAA,KAED,aAAQC,CAAC,EAAE;MACT,IAAI,CAACZ,SAAS,GAAGS,IAAI,CAACI,KAAK,CAACD,CAAC,CAAC;MAC9B,IAAI,CAACX,YAAY,GAAGQ,IAAI,CAACI,KAAK,CAAC,CAACD,CAAC,GAAG,IAAI,CAACZ,SAAS,IAAI,IAAI,CAACW,QAAQ,CAAC;IACtE;EAAC;IAAA;IAAA,KAED,eAAU;MACR,OAAO,IAAI,CAACT,SAAS,GAAIO,IAAI,CAACC,GAAG,CAAC,IAAI,CAACI,SAAS,GAAG,CAAC,EAAE,IAAI,CAACX,YAAY,CAAC,GAAG,IAAI,CAACW,SAAU;IAC5F,CAAC;IAAA,KAED,aAAQF,CAAC,EAAE;MACT,IAAI,CAACV,SAAS,GAAGO,IAAI,CAACI,KAAK,CAACD,CAAC,CAAC;MAC9B,IAAI,CAACT,YAAY,GAAGM,IAAI,CAACI,KAAK,CAAC,CAACD,CAAC,GAAG,IAAI,CAACV,SAAS,IAAI,IAAI,CAACY,SAAS,CAAC;IACvE;EAAC;IAAA;IAAA,KAED,eAAe;MACb,OAAO,IAAI,CAACjB,SAAS,IACnB,IAAI,CAACA,SAAS,CAACkB,SAAS,CAAC,IAAI,CAACf,SAAS,GAAG,CAAC,CAAC,IAC5C,IAAI,CAACH,SAAS,CAACkB,SAAS,CAAC,IAAI,CAACf,SAAS,GAAG,CAAC,CAAC,CAACgB,aAAa,GACxDP,IAAI,CAACI,KAAK,CAAC,IAAI,CAAChB,SAAS,CAACkB,SAAS,CAAC,IAAI,CAACf,SAAS,GAAG,CAAC,CAAC,CAACiB,KAAK,GAAG,KAAK,CAAC,GACtE,MAAM;IACZ;EAAC;IAAA;IAAA,KAED,eAAgB;MACd,OAAO,IAAI,CAACpB,SAAS,IACnB,IAAI,CAACA,SAAS,CAACqB,MAAM,CAAC,IAAI,CAAChB,SAAS,GAAG,CAAC,CAAC,IACzC,IAAI,CAACL,SAAS,CAACqB,MAAM,CAAC,IAAI,CAAChB,SAAS,GAAG,CAAC,CAAC,CAACiB,MAAM,GAC9CV,IAAI,CAACI,KAAK,CAAC,IAAI,CAAChB,SAAS,CAACqB,MAAM,CAAC,IAAI,CAAChB,SAAS,GAAG,CAAC,CAAC,CAACiB,MAAM,GAAG,KAAK,CAAC,GACpE,MAAM;IACZ;EAAC;IAAA;IAAA,KAED,eAAY;MACV,OAAO;QACLnB,SAAS,EAAE,IAAI,CAACA,SAAS;QACzBC,YAAY,EAAE,IAAI,CAACA,YAAY;QAC/BC,SAAS,EAAE,IAAI,CAACA,SAAS;QACzBC,YAAY,EAAE,IAAI,CAACA;MACrB,CAAC;IACH,CAAC;IAAA,KAED,aAAUiB,KAAK,EAAE;MACf,IAAI,CAACpB,SAAS,GAAGoB,KAAK,CAACpB,SAAS;MAChC,IAAI,CAACC,YAAY,GAAGmB,KAAK,CAACnB,YAAY;MACtC,IAAI,CAACC,SAAS,GAAGkB,KAAK,CAAClB,SAAS;MAChC,IAAI,CAACC,YAAY,GAAGiB,KAAK,CAACjB,YAAY;IACxC;EAAC;IAAA;IAAA,OApDD,oBAAkBkB,KAAK,EAAE;MACvB,OAAOA,KAAK,YAAYzB,MAAM,IAAIyB,KAAK,IAAI,IAAI,GAAGA,KAAK,GAAG,IAAIzB,MAAM,CAACyB,KAAK,CAAC;IAC7E;EAAC;EAAA;AAAA;AAqDHC,MAAM,CAACC,OAAO,GAAG3B,MAAM"}