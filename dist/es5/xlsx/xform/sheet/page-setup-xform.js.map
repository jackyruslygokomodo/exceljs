{"version":3,"file":"page-setup-xform.js","names":["_","require","BaseXform","booleanToXml","model","undefined","pageOrderToXml","cellCommentsToXml","errorsToXml","pageSizeToModel","value","parseInt","PageSetupXform","xmlStream","attributes","paperSize","orientation","horizontalDpi","verticalDpi","pageOrder","blackAndWhite","draft","cellComments","errors","scale","fitToWidth","fitToHeight","firstPageNumber","useFirstPageNumber","usePrinterDefaults","copies","some","leafNode","tag","node","name","module","exports"],"sources":["../../../../../lib/xlsx/xform/sheet/page-setup-xform.js"],"sourcesContent":["const _ = require('../../../utils/under-dash');\nconst BaseXform = require('../base-xform');\n\nfunction booleanToXml(model) {\n  return model ? '1' : undefined;\n}\nfunction pageOrderToXml(model) {\n  switch (model) {\n    case 'overThenDown':\n      return model;\n    default:\n      return undefined;\n  }\n}\nfunction cellCommentsToXml(model) {\n  switch (model) {\n    case 'atEnd':\n    case 'asDisplyed':\n      return model;\n    default:\n      return undefined;\n  }\n}\nfunction errorsToXml(model) {\n  switch (model) {\n    case 'dash':\n    case 'blank':\n    case 'NA':\n      return model;\n    default:\n      return undefined;\n  }\n}\nfunction pageSizeToModel(value) {\n  return value !== undefined ? parseInt(value, 10) : undefined;\n}\n\nclass PageSetupXform extends BaseXform {\n  get tag() {\n    return 'pageSetup';\n  }\n\n  render(xmlStream, model) {\n    if (model) {\n      const attributes = {\n        paperSize: model.paperSize,\n        orientation: model.orientation,\n        horizontalDpi: model.horizontalDpi,\n        verticalDpi: model.verticalDpi,\n        pageOrder: pageOrderToXml(model.pageOrder),\n        blackAndWhite: booleanToXml(model.blackAndWhite),\n        draft: booleanToXml(model.draft),\n        cellComments: cellCommentsToXml(model.cellComments),\n        errors: errorsToXml(model.errors),\n        scale: model.scale,\n        fitToWidth: model.fitToWidth,\n        fitToHeight: model.fitToHeight,\n        firstPageNumber: model.firstPageNumber,\n        useFirstPageNumber: booleanToXml(model.firstPageNumber),\n        usePrinterDefaults: booleanToXml(model.usePrinterDefaults),\n        copies: model.copies,\n      };\n      if (_.some(attributes, value => value !== undefined)) {\n        xmlStream.leafNode(this.tag, attributes);\n      }\n    }\n  }\n\n  parseOpen(node) {\n    switch (node.name) {\n      case this.tag:\n        this.model = {\n          paperSize: pageSizeToModel(node.attributes.paperSize),\n          orientation: node.attributes.orientation || 'portrait',\n          horizontalDpi: parseInt(node.attributes.horizontalDpi || '4294967295', 10),\n          verticalDpi: parseInt(node.attributes.verticalDpi || '4294967295', 10),\n          pageOrder: node.attributes.pageOrder || 'downThenOver',\n          blackAndWhite: node.attributes.blackAndWhite === '1',\n          draft: node.attributes.draft === '1',\n          cellComments: node.attributes.cellComments || 'None',\n          errors: node.attributes.errors || 'displayed',\n          scale: parseInt(node.attributes.scale || '100', 10),\n          fitToWidth: parseInt(node.attributes.fitToWidth || '1', 10),\n          fitToHeight: parseInt(node.attributes.fitToHeight || '1', 10),\n          firstPageNumber: parseInt(node.attributes.firstPageNumber || '1', 10),\n          useFirstPageNumber: node.attributes.useFirstPageNumber === '1',\n          usePrinterDefaults: node.attributes.usePrinterDefaults === '1',\n          copies: parseInt(node.attributes.copies || '1', 10),\n        };\n        return true;\n      default:\n        return false;\n    }\n  }\n\n  parseText() {}\n\n  parseClose() {\n    return false;\n  }\n}\n\nmodule.exports = PageSetupXform;\n"],"mappings":";;;;;;;;;;;;;;;AAAA,IAAMA,CAAC,GAAGC,OAAO,CAAC,2BAA2B,CAAC;AAC9C,IAAMC,SAAS,GAAGD,OAAO,CAAC,eAAe,CAAC;AAE1C,SAASE,YAAY,CAACC,KAAK,EAAE;EAC3B,OAAOA,KAAK,GAAG,GAAG,GAAGC,SAAS;AAChC;AACA,SAASC,cAAc,CAACF,KAAK,EAAE;EAC7B,QAAQA,KAAK;IACX,KAAK,cAAc;MACjB,OAAOA,KAAK;IACd;MACE,OAAOC,SAAS;EAAC;AAEvB;AACA,SAASE,iBAAiB,CAACH,KAAK,EAAE;EAChC,QAAQA,KAAK;IACX,KAAK,OAAO;IACZ,KAAK,YAAY;MACf,OAAOA,KAAK;IACd;MACE,OAAOC,SAAS;EAAC;AAEvB;AACA,SAASG,WAAW,CAACJ,KAAK,EAAE;EAC1B,QAAQA,KAAK;IACX,KAAK,MAAM;IACX,KAAK,OAAO;IACZ,KAAK,IAAI;MACP,OAAOA,KAAK;IACd;MACE,OAAOC,SAAS;EAAC;AAEvB;AACA,SAASI,eAAe,CAACC,KAAK,EAAE;EAC9B,OAAOA,KAAK,KAAKL,SAAS,GAAGM,QAAQ,CAACD,KAAK,EAAE,EAAE,CAAC,GAAGL,SAAS;AAC9D;AAAC,IAEKO,cAAc;EAAA;EAAA;EAAA;IAAA;IAAA;EAAA;EAAA;IAAA;IAAA,KAClB,eAAU;MACR,OAAO,WAAW;IACpB;EAAC;IAAA;IAAA,OAED,gBAAOC,SAAS,EAAET,KAAK,EAAE;MACvB,IAAIA,KAAK,EAAE;QACT,IAAMU,UAAU,GAAG;UACjBC,SAAS,EAAEX,KAAK,CAACW,SAAS;UAC1BC,WAAW,EAAEZ,KAAK,CAACY,WAAW;UAC9BC,aAAa,EAAEb,KAAK,CAACa,aAAa;UAClCC,WAAW,EAAEd,KAAK,CAACc,WAAW;UAC9BC,SAAS,EAAEb,cAAc,CAACF,KAAK,CAACe,SAAS,CAAC;UAC1CC,aAAa,EAAEjB,YAAY,CAACC,KAAK,CAACgB,aAAa,CAAC;UAChDC,KAAK,EAAElB,YAAY,CAACC,KAAK,CAACiB,KAAK,CAAC;UAChCC,YAAY,EAAEf,iBAAiB,CAACH,KAAK,CAACkB,YAAY,CAAC;UACnDC,MAAM,EAAEf,WAAW,CAACJ,KAAK,CAACmB,MAAM,CAAC;UACjCC,KAAK,EAAEpB,KAAK,CAACoB,KAAK;UAClBC,UAAU,EAAErB,KAAK,CAACqB,UAAU;UAC5BC,WAAW,EAAEtB,KAAK,CAACsB,WAAW;UAC9BC,eAAe,EAAEvB,KAAK,CAACuB,eAAe;UACtCC,kBAAkB,EAAEzB,YAAY,CAACC,KAAK,CAACuB,eAAe,CAAC;UACvDE,kBAAkB,EAAE1B,YAAY,CAACC,KAAK,CAACyB,kBAAkB,CAAC;UAC1DC,MAAM,EAAE1B,KAAK,CAAC0B;QAChB,CAAC;QACD,IAAI9B,CAAC,CAAC+B,IAAI,CAACjB,UAAU,EAAE,UAAAJ,KAAK;UAAA,OAAIA,KAAK,KAAKL,SAAS;QAAA,EAAC,EAAE;UACpDQ,SAAS,CAACmB,QAAQ,CAAC,IAAI,CAACC,GAAG,EAAEnB,UAAU,CAAC;QAC1C;MACF;IACF;EAAC;IAAA;IAAA,OAED,mBAAUoB,IAAI,EAAE;MACd,QAAQA,IAAI,CAACC,IAAI;QACf,KAAK,IAAI,CAACF,GAAG;UACX,IAAI,CAAC7B,KAAK,GAAG;YACXW,SAAS,EAAEN,eAAe,CAACyB,IAAI,CAACpB,UAAU,CAACC,SAAS,CAAC;YACrDC,WAAW,EAAEkB,IAAI,CAACpB,UAAU,CAACE,WAAW,IAAI,UAAU;YACtDC,aAAa,EAAEN,QAAQ,CAACuB,IAAI,CAACpB,UAAU,CAACG,aAAa,IAAI,YAAY,EAAE,EAAE,CAAC;YAC1EC,WAAW,EAAEP,QAAQ,CAACuB,IAAI,CAACpB,UAAU,CAACI,WAAW,IAAI,YAAY,EAAE,EAAE,CAAC;YACtEC,SAAS,EAAEe,IAAI,CAACpB,UAAU,CAACK,SAAS,IAAI,cAAc;YACtDC,aAAa,EAAEc,IAAI,CAACpB,UAAU,CAACM,aAAa,KAAK,GAAG;YACpDC,KAAK,EAAEa,IAAI,CAACpB,UAAU,CAACO,KAAK,KAAK,GAAG;YACpCC,YAAY,EAAEY,IAAI,CAACpB,UAAU,CAACQ,YAAY,IAAI,MAAM;YACpDC,MAAM,EAAEW,IAAI,CAACpB,UAAU,CAACS,MAAM,IAAI,WAAW;YAC7CC,KAAK,EAAEb,QAAQ,CAACuB,IAAI,CAACpB,UAAU,CAACU,KAAK,IAAI,KAAK,EAAE,EAAE,CAAC;YACnDC,UAAU,EAAEd,QAAQ,CAACuB,IAAI,CAACpB,UAAU,CAACW,UAAU,IAAI,GAAG,EAAE,EAAE,CAAC;YAC3DC,WAAW,EAAEf,QAAQ,CAACuB,IAAI,CAACpB,UAAU,CAACY,WAAW,IAAI,GAAG,EAAE,EAAE,CAAC;YAC7DC,eAAe,EAAEhB,QAAQ,CAACuB,IAAI,CAACpB,UAAU,CAACa,eAAe,IAAI,GAAG,EAAE,EAAE,CAAC;YACrEC,kBAAkB,EAAEM,IAAI,CAACpB,UAAU,CAACc,kBAAkB,KAAK,GAAG;YAC9DC,kBAAkB,EAAEK,IAAI,CAACpB,UAAU,CAACe,kBAAkB,KAAK,GAAG;YAC9DC,MAAM,EAAEnB,QAAQ,CAACuB,IAAI,CAACpB,UAAU,CAACgB,MAAM,IAAI,GAAG,EAAE,EAAE;UACpD,CAAC;UACD,OAAO,IAAI;QACb;UACE,OAAO,KAAK;MAAC;IAEnB;EAAC;IAAA;IAAA,OAED,qBAAY,CAAC;EAAC;IAAA;IAAA,OAEd,sBAAa;MACX,OAAO,KAAK;IACd;EAAC;EAAA;AAAA,EA9D0B5B,SAAS;AAiEtCkC,MAAM,CAACC,OAAO,GAAGzB,cAAc"}